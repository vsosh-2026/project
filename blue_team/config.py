import os
from pathlib import Path

# =============================================================================
# БАЗОВЫЕ НАСТРОЙКИ ПУТЕЙ
# =============================================================================

# Корень проекта (относительно этого файла)
# blue_team/config.py -> parent -> blue_team -> parent -> PROJECT_ROOT
BASE_DIR = Path(__file__).resolve().parent.parent

# Папка для хранения данных (БД, ключи)
DATA_DIR = BASE_DIR / "data"

# Файл базы данных SQLite
DB_PATH = DATA_DIR / "security.db"

# Файл мастер-ключа шифрования (AES-256 GCM)
# Этот файл защищен Windows DPAPI (связан с железом/пользователем)
KEY_VAULT_PATH = DATA_DIR / "master.key"

# Файл токена авторизации для IPC (межпроцессное взаимодействие)
# Сервис создает его, клиенты (Конфигуратор, Вьювер) читают
TOKEN_PATH = DATA_DIR / "ipc_session.token"

# =============================================================================
# НАСТРОЙКИ БЕЗОПАСНОСТИ
# =============================================================================

# Интервал проверки лица (в секундах)
# 0.5 = 2 раза в секунду. Оптимально для баланса нагрузка/реакция.
FACE_CHECK_INTERVAL = 0.2

# Индекс камеры (0 - первая камера в системе)
CAMERA_INDEX = 1

# Строгость сравнения лиц (0.0 - строго, 1.0 - всех пускать)
# 0.6 - рекомендованный стандарт dlib
FACE_TOLERANCE = 0.6

# Масштаб кадра перед обработкой (для ускорения)
# 0.25 = уменьшить в 4 раза (быстрее в 16 раз)
FRAME_SCALING = 0.25

# Время жизни кэша состояния камеры (не используется в новой IPC архитектуре, но можно оставить)
CAMERA_STATE_TTL = 2.0

# =============================================================================
# ИНИЦИАЛИЗАЦИЯ
# =============================================================================

# Автосоздание папки data при импорте конфига
if not DATA_DIR.exists():
    try:
        DATA_DIR.mkdir(parents=True, exist_ok=True)
    except OSError as e:
        print(f"[CONFIG CRITICAL] Не удалось создать папку данных: {e}")